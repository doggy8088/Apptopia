name: CI for Issue 3

on:
  push:
    paths:
      - "apps/issue-3/**"
      - ".github/workflows/ci_3.yml"
  pull_request:
    paths:
      - "apps/issue-3/**"
      - ".github/workflows/ci_3.yml"

jobs:
  # Phase 0: Planning and validation
  validate-structure:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Verify project structure
        working-directory: apps/issue-3
        run: |
          echo "âœ… Checking project structure..."
          
          # Check required directories exist
          for dir in src tests docs data; do
            if [ -d "$dir" ]; then
              echo "âœ… Directory '$dir' exists"
            else
              echo "âŒ Directory '$dir' is missing"
              exit 1
            fi
          done
          
          # Check README exists
          if [ -f "README.md" ]; then
            echo "âœ… README.md exists"
          else
            echo "âŒ README.md is missing"
            exit 1
          fi
          
          echo "âœ… All structure checks passed"

      - name: Validate test data
        working-directory: apps/issue-3
        run: |
          echo "ğŸ“Š Checking test data..."
          
          if [ -d "data/test-data" ]; then
            echo "âœ… Test data directory exists"
            
            # Count markdown files
            md_count=$(find data/test-data -type f -name "*.md" | wc -l)
            echo "ğŸ“ Found $md_count Markdown files"
            
            # Count image files
            img_count=$(find data/test-data -type f \( -name "*.jpg" -o -name "*.jpeg" -o -name "*.png" \) | wc -l)
            echo "ğŸ–¼ï¸ Found $img_count image files"
            
            if [ $md_count -gt 0 ]; then
              echo "âœ… Test data is present"
            else
              echo "âš ï¸ No markdown files found in test data"
            fi
          else
            echo "âš ï¸ Test data directory not found (expected during initial setup)"
          fi

      - name: Validate documentation
        working-directory: apps/issue-3
        run: |
          echo "ğŸ“š Validating documentation..."
          
          # Check if README contains required sections
          required_sections=(
            "å°ˆæ¡ˆç°¡ä»‹"
            "V1 é–‹ç™¼è¨ˆç•«"
            "é–‹ç™¼é‡Œç¨‹ç¢‘"
            "é©—æ”¶åŸºæº–"
            "åŠŸèƒ½éœ€æ±‚æ¸…å–®"
          )
          
          for section in "${required_sections[@]}"; do
            if grep -q "$section" README.md; then
              echo "âœ… Section '$section' found"
            else
              echo "âš ï¸ Section '$section' not found"
            fi
          done

  # Future jobs will be added here as development progresses
  # 
  # build-and-test:
  #   needs: validate-structure
  #   runs-on: ubuntu-latest
  #   ...
  #
  # package:
  #   needs: build-and-test
  #   runs-on: windows-latest  # Desktop app for Windows
  #   ...
