# Issue #3: AI知識++ - 本機運作的私人知識庫

> **English**: A local private knowledge base desktop application with AI capabilities for document Q&A, relationship analysis, and knowledge graph visualization.

> **中文**：一個支援 AI 對話、關係分析與知識圖譜視覺化的本機私人知識庫桌面應用程式。

---

## 專案狀態

✅ **Phase 0 完成** - 需求凍結與規劃 (100%)  
✅ **Phase 1 完成** - 資料匯入與索引 (95% - 核心功能完成)  
🚧 **Phase 2 準備中** - RAG 對話核心

**最新進度**：
- 8 個核心元件全部實作完成
- 82/85 測試通過 (96.5%)
- 完整文件處理管線運作中
- 已通過 43 個真實 Markdown 檔案驗證
- 支援中文內容處理

詳見 [Phase 1 實作總結](docs/PHASE_1_SUMMARY.md)。

---

## 專案簡介

AI知識++ 是一個專為個人與企業設計的本機知識庫管理工具，幫助使用者：

- 📚 **整理與管理知識**：支援 Markdown、PDF、圖片等多種格式
- 🤖 **AI 對話問答**：透過 RAG（檢索增強生成）技術提供精準回答
- 🔗 **自動關聯分析**：智慧分析文件間的關係並視覺化呈現
- 💾 **資料本機化**：所有資料儲存在本機，確保隱私安全
- 🚀 **離線優先**：無網路環境下也能正常運作

### 目標使用者

- **開發者**：整理 API 文件、技術筆記
- **一般使用者**：建立個人知識庫
- **上班族**：整理公司資料並生成報表

### 要解決的問題

- 個人資料流失與遺忘
- 知識與知識之間的連接
- 看似無關聯資料的價值挖掘

---

## V1 開發計畫

### 目標與範圍

#### V1 核心目標
- **主軸**：本機資料的文件問答（RAG，附來源引用）
- **次要**：摘要/報表生成
- **延後**：API 文件自動整理（先做最小可用）

#### V1 範圍界定
- ✅ 第一版先做 Must 功能，Should/Could 先保留接口不實作
- ✅ 支援多資料夾來源，採手動重新整理
- ✅ 原始資料全程留在本機
- ✅ 若本機未命中，可提示外部查詢且清楚標示非本機來源
- ✅ 原型資料型態先以 **Markdown + JPG** 驗證
- ✅ 平台：**Windows Desktop Application**

---

## 開發里程碑

### Phase 0：需求凍結與驗收題庫

**目標**：確認需求範圍並建立可驗證的測試標準

- [ ] 鎖定 V1 範圍：RAG（附來源）/ 摘要、Windows 桌面、資料格式先支援 Markdown + JPG
- [ ] 下載並盤點 Obsidian 測試資料（✅ 已完成：43 個 Markdown 文件，74 張圖片）
- [ ] 定義「支援/降級」的 Obsidian 語法清單（不支援語法降級為純文字）
- [ ] 建立驗收題庫（>=15 題）與每題預期回答要點

**交付物**：
- 測試資料集文件清單
- Obsidian 語法支援矩陣
- 驗收題庫與評分標準

---

### Phase 1：資料匯入與索引

**目標**：建立穩定的資料匯入與索引系統

- [ ] 多資料夾來源註冊與管理
  - 支援新增/移除資料夾路徑
  - 資料夾狀態管理（活躍/凍結）
  
- [ ] 手動 Refresh（新增/刪除/修改後的增量更新與重建）
  - 檔案變更偵測
  - 增量索引更新
  - 完整重建機制
  
- [ ] JPG OCR 管線（繁中/英文優先）
  - OCR 引擎整合
  - 文字提取與儲存
  - 錯誤處理
  
- [ ] 建立 Chunking、Metadata 與向量索引
  - 文件分塊策略
  - Metadata 提取（標題、標籤、連結）
  - 向量化與索引建立

**交付物**：
- 資料夾管理介面
- 索引建立工具
- OCR 處理模組

**技術選型考量**：
- 向量資料庫：Chroma / FAISS / Qdrant
- OCR 引擎：Tesseract / PaddleOCR
- 文件處理：LangChain / LlamaIndex

---

### Phase 2：RAG 對話核心

**目標**：實作核心的問答功能

- [ ] 問答回覆附來源片段與檔案路徑
  - 精準檢索相關片段
  - 來源歸屬標記
  - 置信度評分
  
- [ ] 本機未命中時回覆「本機資料不足」並提供外部查詢選項
  - 未命中檢測邏輯
  - 外部查詢提示機制
  - 來源標示（本機 vs 外部）
  
- [ ] 支援基本多輪上下文
  - 對話歷史管理
  - 上下文窗口
  - 參考前文的能力

**交付物**：
- RAG 問答引擎
- 對話管理系統
- 來源追蹤機制

**對話範例**：
```
使用者：Rust 的所有權規則是什麼？
AI：根據本機文件「Rust 所有權.md」，Rust 的所有權規則包括：
1. 每個值都有一個變數作為其所有者
2. 一次只能有一個所有者
3. 當所有者離開作用域時，值會被丟棄

[來源：Card卡片盒/學習/程式/Rust/Rust 所有權.md, Line 15-20]
```

---

### Phase 3：關聯分析與知識圖譜

**目標**：實作知識關聯視覺化功能

- [ ] 關鍵字 + 向量相似度混合關聯計分
  - 關鍵字共現分析
  - 向量相似度計算
  - 混合評分策略
  
- [ ] 提供 Obsidian 風格的基礎節點連線視圖
  - 節點：文件
  - 邊：關聯關係與強度
  - 互動式圖形介面
  
- [ ] 支援從當前文件展開 1~2 層關聯
  - 點擊節點展開相關文件
  - 關聯層級控制
  - 視覺化過濾

**交付物**：
- 關聯分析引擎
- 知識圖譜視覺化介面
- 圖譜互動功能

**視覺化技術**：
- D3.js / Cytoscape.js / Vis.js
- Force-directed graph layout

---

### Phase 4：資料庫遷移與來源驗證

**目標**：支援資料備份與跨裝置使用

- [ ] 匯出/匯入索引資料
  - 索引資料序列化
  - 壓縮與加密選項
  - 版本相容性
  
- [ ] 遷移後來源驗證（缺失來源標記「凍結」，存在來源可持續更新）
  - 來源路徑驗證
  - 狀態標記機制
  - 差異報告
  
- [ ] 產出遷移驗證報告（例如 A/C 可更新、B 缺失）
  - 可用來源清單
  - 缺失來源清單
  - 建議操作

**交付物**：
- 匯出/匯入工具
- 來源驗證模組
- 遷移報告生成器

**遷移情境範例**：
```
原始裝置資料夾：
- A: D:\Documents\Notes
- B: E:\WorkDocs
- C: D:\Projects\Docs

遷移後新裝置：
- A: C:\Users\User\Notes (✅ 可更新)
- B: 不存在 (❌ 凍結)
- C: D:\MyProjects\Docs (✅ 可更新)
```

---

### Phase 5：驗收與交付

**目標**：完成功能驗收並交付可用版本

- [ ] 依題庫完成功能驗收
  - 執行所有測試案例
  - 記錄測試結果
  - 修正發現的問題
  
- [ ] Windows 打包與執行驗證
  - 打包成可執行檔
  - 安裝程式製作
  - 不同 Windows 版本測試
  
- [ ] 交付使用說明與限制清單（語法差異/OCR 限制/效能邊界）
  - 使用手冊
  - 已知限制說明
  - FAQ

**交付物**：
- Windows 安裝包
- 使用文件
- 限制與已知問題清單

**打包技術**：
- Electron / Tauri / PyQt
- NSIS / Inno Setup (安裝程式)

---

## 驗收基準（V1）

### 必須達成的標準

1. ✅ **基本問答**：能以測試資料集完成「問答 + 來源引用」
2. ✅ **摘要生成**：可生成指定文件的摘要
3. ✅ **關聯視覺化**：可顯示至少一張有效關聯圖
4. ✅ **資料遷移**：可完成一次資料庫遷移並產出來源驗證結果

### 測試案例範例

#### 測試案例 1：基本問答
```
問題：Rust 的字串類型有哪些？
預期回答：應提及 String 和 &str，並附上來源文件路徑
來源檔案：Card卡片盒/學習/程式/Rust/Rust String.md
```

#### 測試案例 2：跨文件關聯
```
問題：Rust 的所有權和引用有什麼關係？
預期回答：應整合「Rust 所有權.md」和「Rust 引用.md」的內容
來源檔案：兩個或以上相關文件
```

#### 測試案例 3：本機未命中
```
問題：Python 的 asyncio 如何使用？
預期回答：本機資料不足，是否需要外部查詢協助？
行為：不應直接回答，應提示資料缺失
```

---

## 功能需求清單

### Must（必須有，否則不算完成）

- [x] 資料庫（向量索引）
- [ ] AI 對話（RAG 問答）
- [ ] AI 自動連接資料關聯性（最好可以輸出關係圖）

### Should（最好有，但可延後）

- [ ] MCP (Model Context Protocol) 整合
- [ ] Skill 功能（可擴展的功能模組）
- [ ] 圖片 OCR
- [ ] 資料庫遷移功能

### Could（加分項）

- [ ] Agent 功能（自主任務執行）
- [ ] 自動摘要與報表產生
- [ ] 網址內容擷取
- [ ] PDF 支援

---

## 技術架構（規劃中）

### 前端技術棧

- **UI 框架**：Electron / Tauri / Qt
- **視覺化**：D3.js / Cytoscape.js
- **狀態管理**：待定

### 後端技術棧

- **語言**：Python / Rust（待評估）
- **向量資料庫**：Chroma / FAISS / Qdrant
- **LLM 整合**：LangChain / LlamaIndex
- **OCR**：Tesseract / PaddleOCR

### 資料處理

- **文件解析**：Markdown-it / unified
- **分塊策略**：Semantic chunking / Fixed-size chunking
- **向量模型**：待選擇（需支援中文）

---

## 測試資料

### 資料集來源

本專案使用從 Issue 討論中提供的 Obsidian 筆記資料集作為測試資料。

**資料統計**：
- 📝 Markdown 文件：43 個
- 🖼️ 圖片檔案：74 個
- 📁 主要目錄結構：
  - `Atlas地圖集/` - 知識地圖與 MOC (Map of Content)
  - `Card卡片盒/` - 學習筆記（程式、AI、數學等）
  - `Source來源筆記/` - 原始參考資料

**資料位置**：
```
apps/issue-3/data/test-data/
```

### 支援的 Obsidian 語法（待定義）

以下是計劃中需要支援或降級處理的 Obsidian 語法：

#### 完整支援
- [ ] Markdown 基本語法（標題、清單、連結、圖片）
- [ ] 內部連結 `[[文件名稱]]`
- [ ] 標籤 `#tag`
- [ ] 前置元數據 (YAML frontmatter)

#### 降級處理（轉為純文字）
- [ ] Callouts / Admonitions
- [ ] Dataview 查詢
- [ ] 嵌入內容 `![[文件名稱]]`
- [ ] 複雜的表格格式

---

## 安裝與執行（尚未開發）

### 系統需求

- **作業系統**：Windows 10/11 (64-bit)
- **記憶體**：建議 8GB 以上
- **硬碟空間**：至少 2GB 可用空間
- **其他**：需要離線 LLM 模型（或 API 金鑰）

### 安裝步驟（待實作）

```bash
# 步驟將在開發完成後提供
```

---

## 開發進度

### Phase 0: 需求凍結與驗收題庫
🚧 **進行中**
- [x] 測試資料準備（Obsidian 範例資料）
- [ ] Obsidian 語法支援清單
- [ ] 驗收題庫建立（目標 >=15 題）

### Phase 1: 資料匯入與索引
⏳ **尚未開始**

### Phase 2: RAG 對話核心
⏳ **尚未開始**

### Phase 3: 關聯分析與知識圖譜
⏳ **尚未開始**

### Phase 4: 資料庫遷移與來源驗證
⏳ **尚未開始**

### Phase 5: 驗收與交付
⏳ **尚未開始**

---

## 相關連結

- 原始 Issue：[#3](https://github.com/doggy8088/Apptopia/issues/3)
- CI/CD Workflow：`.github/workflows/ci_3.yml`（待建立）
- 測試資料：`apps/issue-3/data/test-data/`

---

## 授權

本專案遵循專案主授權協議。

---

## 貢獻

目前專案處於規劃階段，尚未開放貢獻。待 Phase 1 完成後會開放參與。

---

## 常見問題

### Q: 為什麼選擇本機運作而非雲端？
A: 確保使用者的知識資料完全私密，不會上傳到任何第三方伺服器。

### Q: 需要連接網路嗎？
A: 核心功能完全離線運作。僅在本機資料未命中且使用者同意時，才會進行外部查詢。

### Q: 支援哪些 LLM 模型？
A: V1 規劃支援本機執行的開源模型（如 Llama、Mistral）或透過 API 使用（OpenAI、Anthropic 等）。

### Q: 為什麼 V1 只支援 Markdown 和 JPG？
A: 為了快速驗證核心功能，先以最常見的格式開始。後續版本會擴展支援 PDF、Word 等格式。

### Q: 知識圖譜的準確度如何？
A: V1 採用關鍵字 + 向量相似度混合策略，準確度依賴於文件內容的品質與數量。使用者可手動調整關聯閾值。

---

## 更新日誌

### 2026-02-17
- 🎉 專案初始化
- 📋 完成 V1 開發計畫規劃
- 📦 準備測試資料集（43 個 Markdown 文件，74 張圖片）
- 📝 建立專案 README 與目錄結構

---

**最後更新**：2026-02-17  
**專案狀態**：Phase 0 - 規劃中  
**預計 V1 完成時間**：待評估
