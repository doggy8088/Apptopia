# 驗收測試案例

## 概述

本文件定義 AI知識++ V1 的完整驗收測試案例，用於驗證核心功能是否符合需求。

**測試資料來源**：`apps/issue-3/data/test-data/` (43 個 Markdown 文件，74 張圖片)

**建立日期**：2026-02-17

**版本**：V1.0

---

## 測試策略

### 測試分類

1. **基本問答類**（Q1-Q5）：單一文件檢索與回答
2. **跨文件關聯類**（Q6-Q10）：多文件整合回答
3. **本機未命中類**（Q11-Q13）：資料缺失處理
4. **摘要生成類**（Q14-Q15）：文件/主題摘要

### 評分標準

每個測試案例滿分 10 分，評分維度：

- **準確性**（4 分）：回答正確性與完整性
- **來源引用**（3 分）：來源標示的準確性
- **相關性**（2 分）：回答與問題的相關程度
- **可讀性**（1 分）：格式清晰度

**通過標準**：
- 單一案例：>= 7 分
- 整體通過率：>= 80% (12/15 題)
- 關鍵測試（Q1-Q5, Q11-Q13）：必須 100% 通過

---

## 測試案例

### Q1: 單一文件問答 - 核心概念

**類別**：基本問答

**問題**：
```
Rust 的所有權規則是什麼？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust 所有權.md`

**預期回答要點**：
1. 必須提及三個核心規則：
   - 每個值都有一個所有者
   - 一次只能有一個所有者
   - 當所有者離開作用域時，值會被丟棄
2. 可選：提及作用域概念
3. 可選：舉例說明

**評分標準**：
- **準確性（4 分）**
  - 4 分：提及全部三個規則且正確
  - 3 分：提及兩個規則且正確
  - 2 分：提及一個規則且正確
  - 1 分：有嘗試回答但不完整
  - 0 分：完全錯誤或無關

- **來源引用（3 分）**
  - 3 分：檔名 + 行號範圍或具體片段
  - 2 分：僅檔名，但正確
  - 1 分：來源不完整
  - 0 分：無來源或錯誤來源

- **相關性（2 分）**
  - 2 分：直接回答問題，高度相關
  - 1 分：部分相關
  - 0 分：不相關

- **可讀性（1 分）**
  - 1 分：格式清晰，易讀
  - 0 分：格式混亂

**範例輸出**：
```markdown
根據本機文件，Rust 的所有權規則包括三個核心原則：

1. **每個值都有一個所有者（owner）**
2. **值在任一時刻有且只有一個所有者**
3. **當所有者（變數）離開作用域，這個值將被丟棄**

這些規則主要用於防止記憶體洩漏，確保記憶體安全。

**來源**：
- Card卡片盒/學習/程式/Rust/Rust 所有權.md (第16-18行)
```

---

### Q2: 特定概念查詢 - 資料類型

**類別**：基本問答

**問題**：
```
Rust 中 String 和 &str 的差異是什麼？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust String.md`

**預期回答要點**：
1. String：可變長度字串，堆積配置
2. &str：字串切片，固定長度，可為堆積或棧
3. 使用場景差異
4. 可選：所有權相關說明

**評分標準**：同 Q1

**範例輸出**：
```markdown
String 和 &str 的主要差異：

- **String**：可變長度的字串類型，資料儲存在堆積（heap）上，擁有所有權
- **&str**：字串切片（string slice），固定長度，通常是對 String 的引用或字串字面值

**使用時機**：
- 需要修改或擁有字串：使用 String
- 僅讀取字串內容：使用 &str

**來源**：
- Card卡片盒/學習/程式/Rust/Rust String.md
```

---

### Q3: 實作方法查詢

**類別**：基本問答

**問題**：
```
如何在 Rust 中使用 HashMap？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust HashMap.md`

**預期回答要點**：
1. 建立 HashMap
2. 新增/更新元素
3. 查詢元素
4. 刪除元素
5. 可選：迭代方法

**評分標準**：
- 準確性（4 分）：提及至少 3 個操作方法
- 來源引用（3 分）：正確標示來源
- 相關性（2 分）：直接回答如何使用
- 可讀性（1 分）：格式清晰

**範例輸出**：
```markdown
Rust HashMap 的基本使用方法：

1. **建立 HashMap**：
   ```rust
   use std::collections::HashMap;
   let mut map = HashMap::new();
   ```

2. **新增/更新**：
   ```rust
   map.insert("key", "value");
   ```

3. **查詢**：
   ```rust
   let value = map.get("key");
   ```

4. **刪除**：
   ```rust
   map.remove("key");
   ```

**來源**：
- Card卡片盒/學習/程式/Rust/Rust HashMap.md
```

---

### Q4: 概念列舉

**類別**：基本問答

**問題**：
```
Rust 有哪些常用的 Trait？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust std標準庫 Trait.md`
- 可能：`Card卡片盒/學習/程式/Rust/Rust Trait 特徵.md`

**預期回答要點**：
1. 列出主要 Trait（如 Clone, Copy, Debug, Display, Drop 等）
2. 簡單說明各 Trait 用途
3. 可選：分類（衍生 trait, 運算符 trait 等）

**評分標準**：
- 準確性（4 分）：列出 >= 5 個正確的 Trait
- 來源引用（3 分）：正確標示來源
- 相關性（2 分）：回答常用 Trait
- 可讀性（1 分）：清單格式清晰

---

### Q5: 比較類問題

**類別**：基本問答

**問題**：
```
Vector 和陣列在 Rust 中有什麼不同？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust Vector.md`
- 可能：相關語言基本文件

**預期回答要點**：
1. 大小：Vector 可變，陣列固定
2. 儲存位置：Vector 在堆積，陣列可在棧
3. 使用場景差異
4. 效能考量（可選）

**評分標準**：同 Q1

---

### Q6: 概念關聯 - 跨文件

**類別**：跨文件關聯

**問題**：
```
Rust 的所有權和引用有什麼關係？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust 所有權.md`
- `Card卡片盒/學習/程式/Rust/Rust 引用.md`

**預期回答要點**：
1. 引用允許在不轉移所有權的情況下使用值
2. 借用（borrowing）概念
3. 可變引用與不可變引用的規則
4. 引用如何防止記憶體問題

**評分標準**：
- 準確性（4 分）：整合兩個概念，說明關係
- 來源引用（3 分）：**必須引用至少兩個檔案**
- 相關性（2 分）：說明兩者關係
- 可讀性（1 分）：邏輯清晰

**範例輸出**：
```markdown
所有權和引用的關係：

Rust 的**引用（reference）**允許我們在不轉移所有權的情況下使用值。這稱為**借用（borrowing）**。

**關鍵關係**：
1. 引用不擁有值，僅借用
2. 原所有者在引用存在期間保持所有權
3. 引用遵守借用規則：
   - 可以有多個不可變引用
   - 或只有一個可變引用
   - 但不能同時存在

這種設計確保了記憶體安全，防止資料競爭。

**來源**：
- Card卡片盒/學習/程式/Rust/Rust 所有權.md（所有權規則）
- Card卡片盒/學習/程式/Rust/Rust 引用.md（引用與借用）
```

---

### Q7: 功能串聯

**類別**：跨文件關聯

**問題**：
```
如何使用泛型實作一個通用的 Struct？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust 泛型.md`
- `Card卡片盒/學習/程式/Rust/Rust Struct.md`

**預期回答要點**：
1. Struct 定義語法
2. 泛型參數宣告
3. 實作方法時的泛型使用
4. 可選：trait bound

**評分標準**：同 Q6（至少兩個來源）

---

### Q8: 錯誤處理場景

**類別**：跨文件關聯

**問題**：
```
在 Rust 中如何優雅地處理錯誤？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust 錯誤訊息.md`
- 可能：Enum, Option 相關文件

**預期回答要點**：
1. Result<T, E> 類型
2. ? 運算符
3. 錯誤傳播
4. 可選：自定義錯誤類型

**評分標準**：同 Q6

---

### Q9: 進階概念整合

**類別**：跨文件關聯

**問題**：
```
Enum、match 和 if let 如何搭配使用？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust Enum枚舉.md`
- `Card卡片盒/學習/程式/Rust/Rust match & if let.md`

**預期回答要點**：
1. Enum 定義方式
2. match 進行模式匹配
3. if let 簡化單一模式匹配
4. 使用場景與範例

**評分標準**：同 Q6

---

### Q10: 語言特性比較

**類別**：跨文件關聯

**問題**：
```
Slice 和 Vector 的切片操作有什麼關係？
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Slice 切片.md`
- `Card卡片盒/學習/程式/Rust/Rust Vector.md`

**預期回答要點**：
1. Slice 作為 Vector 的 view
2. 切片語法與操作
3. 借用關係
4. 使用場景

**評分標準**：同 Q6

---

### Q11: 不存在的主題

**類別**：本機未命中

**問題**：
```
Python 的 asyncio 如何使用？
```

**預期行為**：
- ❌ **不應該**直接回答問題
- ✅ **必須**明確說明「本機資料庫中未找到相關資料」
- ✅ **應該**提供外部查詢選項
- ✅ **可選**：建議相關本機資料（如其他語言的非同步處理）

**評分標準**：
- **準確性（4 分）**
  - 4 分：明確說明無資料，不提供錯誤資訊
  - 3 分：說明無資料，但提供了猜測性資訊
  - 0 分：直接回答（錯誤行為）

- **來源引用（3 分）**
  - 3 分：明確標示「本機無此資料」
  - 0 分：標示有來源（錯誤）

- **相關性（2 分）**
  - 2 分：提供有用的替代建議
  - 1 分：僅說明無資料
  - 0 分：不相關回應

- **可讀性（1 分）**
  - 1 分：清晰說明情況
  - 0 分：混亂或誤導

**範例輸出**：
```markdown
❌ **本機資料不足**

本機知識庫中未找到關於「Python asyncio」的相關資料。

**建議操作**：
1. 🌐 是否需要進行外部查詢？（將從網路搜尋相關資訊）
2. 📁 您可能想查看本機的其他非同步處理相關內容：
   - Rust 的非同步處理
   - 其他語言的並發處理

**來源**：無（本機資料庫未包含此主題）
```

---

### Q12: 部分相關但不足

**類別**：本機未命中

**問題**：
```
C++ 的 RAII 和 Rust 的所有權有什麼關係？
```

**預期行為**：
- ✅ 找到 Rust 所有權相關內容
- ✅ 說明 C++ RAII 資料不足
- ✅ 僅回答 Rust 部分，明確標示 C++ 資料缺失
- ✅ 可選：提供外部查詢 C++ 部分的選項

**評分標準**：
- 準確性（4 分）：正確回答已知部分，明確標示未知部分
- 來源引用（3 分）：正確標示 Rust 來源，明確說明 C++ 無來源
- 相關性（2 分）：部分回答有用
- 可讀性（1 分）：清楚區分已知與未知

**範例輸出**：
```markdown
**部分回答（本機資料有限）**

關於 Rust 所有權，本機資料如下：
[Rust 所有權的相關說明...]

**來源**：Card卡片盒/學習/程式/Rust/Rust 所有權.md

---

⚠️ **C++ RAII 資料不足**

本機知識庫中未找到關於「C++ RAII」的詳細資料，無法比較兩者關係。

**建議**：
- 🌐 是否需要查詢 C++ RAII 的相關資訊？
- 或者僅參考 Rust 所有權的概念
```

---

### Q13: 完全無關主題

**類別**：本機未命中

**問題**：
```
如何製作巧克力蛋糕？
```

**預期行為**：
- ✅ 明確回應「此問題超出知識庫範圍」
- ✅ **不應該**嘗試回答
- ✅ 可選：建議使用通用搜尋引擎

**評分標準**：同 Q11

**範例輸出**：
```markdown
❌ **超出知識庫範圍**

此問題與本機知識庫的內容範圍（程式設計、AI 工具、技術筆記）不相關。

**建議**：
- 🌐 請使用通用搜尋引擎（如 Google）查詢烹飪相關資訊
- 📚 本知識庫專注於技術文件與程式設計內容

**可用主題**：Rust, C++, Zig, AI 工具, 數學等
```

---

### Q14: 單一文件摘要

**類別**：摘要生成

**問題**：
```
請摘要「Rust 所有權.md」的內容
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/Rust 所有權.md`

**預期回答要點**：
1. 所有權的核心概念
2. 三個基本規則
3. 作用域的作用
4. 權限與拷貝
5. 字數：200-300 字

**評分標準**：
- 準確性（4 分）：摘要涵蓋主要概念
- 來源引用（3 分）：標示來源檔案
- 相關性（2 分）：摘要精簡且相關
- 可讀性（1 分）：結構清晰，易讀

**範例輸出**：
```markdown
**Rust 所有權概念摘要**

所有權是 Rust 最重要的特性，用於確保記憶體安全並避免垃圾回收機制。

**核心規則**：
1. 每個值都有一個所有者
2. 一次只能有一個所有者
3. 所有者離開作用域時，值被丟棄

**作用域**：使用大括號 `{}` 定義，變數在離開作用域時自動釋放。

**權限機制**：
- 會更動記憶體的類型（String, List）禁止淺拷貝
- 不更動的類型（i32, bool）可以淺拷貝
- 可使用 `clone()` 進行深拷貝

這些規則確保記憶體安全，防止資料競爭與記憶體洩漏。

**來源**：Card卡片盒/學習/程式/Rust/Rust 所有權.md  
**字數**：約 180 字
```

---

### Q15: 主題摘要

**類別**：摘要生成

**問題**：
```
請摘要所有 Rust 相關的文件
```

**預期來源檔案**：
- `Card卡片盒/學習/程式/Rust/` 下的所有文件（約 20+ 個）
- `Atlas地圖集/MOC/Rust MOC.md`

**預期回答要點**：
1. 主題概覽（Rust 是什麼）
2. 主要子主題列表
3. 文件數量統計
4. 核心概念提及
5. 字數：300-500 字

**評分標準**：
- 準確性（4 分）：涵蓋主要主題
- 來源引用（3 分）：列出主要文件清單
- 相關性（2 分）：提供有用的概覽
- 可讀性（1 分）：結構化呈現

**範例輸出**：
```markdown
**Rust 知識庫主題摘要**

本知識庫包含 20+ 篇 Rust 相關文件，涵蓋從基礎到進階的多個主題。

**核心主題**：

1. **安全觀念**（6 篇）
   - 所有權、引用、切片
   - 生命週期、錯誤處理
   - 測試

2. **資料類型**（6 篇）
   - Struct, Enum, Option
   - String, Vector, HashMap
   - Type 別名

3. **語言特性**（5 篇）
   - 泛型、Trait
   - match 與 if let
   - 屬性、Drop

4. **實用工具**（3 篇）
   - Debug 技巧、測試、錯誤訊息

**總覽**：
Rust 是一個非常注重安全的程式語言，所有設計規則都是為了記憶體安全與防止資料競爭。知識庫詳細記錄了 Rust 的核心概念、資料結構與最佳實踐。

**參考入口**：Atlas地圖集/MOC/Rust MOC.md  
**文件數量**：20+ 篇  
**字數**：約 200 字
```

---

## 自動化測試腳本設計

### 測試執行流程

```python
# 偽代碼：測試執行框架
def run_acceptance_tests():
    results = []
    
    for test_case in TEST_CASES:
        # 1. 執行問答
        response = ai_knowledge_app.query(test_case.question)
        
        # 2. 評分
        score = evaluate_response(
            response=response,
            expected_sources=test_case.expected_sources,
            expected_points=test_case.expected_points,
            scoring_criteria=test_case.scoring
        )
        
        # 3. 記錄結果
        results.append({
            'test_id': test_case.id,
            'question': test_case.question,
            'score': score,
            'passed': score >= 7,
            'response': response
        })
    
    # 4. 生成報告
    generate_report(results)
    
    return results
```

### 評分函數

```python
def evaluate_response(response, expected_sources, expected_points, scoring_criteria):
    score = 0
    
    # 準確性評分（人工 + 關鍵詞檢查）
    accuracy_score = check_accuracy(response, expected_points)
    score += accuracy_score
    
    # 來源引用評分（自動檢查）
    source_score = check_sources(response.sources, expected_sources)
    score += source_score
    
    # 相關性評分（人工）
    relevance_score = check_relevance(response, expected_points)
    score += relevance_score
    
    # 可讀性評分（格式檢查）
    readability_score = check_readability(response)
    score += readability_score
    
    return score
```

---

## 驗收報告範本

### 測試執行記錄

```markdown
# 驗收測試報告

**測試日期**：2026-XX-XX  
**測試版本**：V1.0  
**測試環境**：Windows 10, Python 3.10

## 測試結果總覽

| 類別 | 通過 | 失敗 | 通過率 |
|------|------|------|--------|
| 基本問答（Q1-Q5） | 5/5 | 0/5 | 100% |
| 跨文件關聯（Q6-Q10） | 4/5 | 1/5 | 80% |
| 本機未命中（Q11-Q13） | 3/3 | 0/3 | 100% |
| 摘要生成（Q14-Q15） | 2/2 | 0/2 | 100% |
| **總計** | **14/15** | **1/15** | **93%** |

**整體評估**：✅ 通過（>= 80%）

## 詳細結果

### Q1: Rust 所有權規則

- **得分**：9/10
- **準確性**：4/4 ✅
- **來源引用**：3/3 ✅
- **相關性**：2/2 ✅
- **可讀性**：0/1 ⚠️ (格式可改進)
- **狀態**：✅ 通過

### Q6: 所有權和引用關係（跨文件）

- **得分**：6/10
- **準確性**：3/4 ⚠️ (概念不完整)
- **來源引用**：1/3 ❌ (僅引用一個來源)
- **相關性**：2/2 ✅
- **可讀性**：0/1 ⚠️
- **狀態**：❌ 未通過（需改進）

[其他案例...]

## 改進建議

1. **Q6 來源引用**：需確保跨文件問題引用多個來源
2. **格式優化**：統一回答格式，提升可讀性
3. **效能**：平均回應時間 3.2 秒，符合 < 5 秒要求

## 結論

V1.0 版本通過驗收測試，達到 93% 通過率（超過 80% 門檻）。
關鍵功能（基本問答、未命中處理）100% 通過。

建議在正式發布前修正 Q6 的跨文件引用問題。
```

---

## 附錄：測試資料快速參考

### Rust 主題文件清單

| 文件名 | 主題 | 行數（估） |
|--------|------|-----------|
| Rust 所有權.md | 核心概念 | 80+ |
| Rust 引用.md | 借用 | 60+ |
| Rust String.md | 字串類型 | 70+ |
| Rust Vector.md | 動態陣列 | 65+ |
| Rust HashMap.md | 雜湊表 | 55+ |
| Rust Enum枚舉.md | 列舉類型 | 75+ |
| Rust match & if let.md | 模式匹配 | 50+ |
| Rust 泛型.md | 泛型 | 60+ |
| Rust Trait 特徵.md | Trait | 80+ |
| Rust std標準庫 Trait.md | 標準 Trait | 90+ |
| ... | ... | ... |

### 標籤分布

- `#程式語言/Rust`: 20+ 文件
- `#學習筆記`: 30+ 文件
- `#rust`: 15+ 文件

---

## 更新記錄

- **2026-02-17**：初版建立，定義 15 個測試案例
- **待更新**：實際測試執行後的結果與調整

---

**狀態**：✅ 完成  
**下一步**：Phase 0 完成，進入 Phase 1 開發  
**預計影響**：Phase 5 驗收（Week 16-18）
