# Phase 0: 需求凍結與驗收題庫

## 目標

確認需求範圍並建立可驗證的測試標準，為後續開發建立明確的驗收基準。

## 任務清單

### 1. 測試資料整理 ✅

- [x] 下載 Obsidian 測試資料
- [x] 統計資料內容
  - 43 個 Markdown 文件
  - 74 張圖片
  - 3 個主要目錄（Atlas地圖集、Card卡片盒、Source來源筆記）

### 2. Obsidian 語法支援清單

需要定義哪些 Obsidian 特殊語法需要完整支援，哪些可以降級處理。

#### 2.1 完整支援語法（Priority 1）

- [ ] **基本 Markdown**
  - [ ] 標題 (# ## ### 等)
  - [ ] 清單（有序、無序）
  - [ ] 粗體、斜體、刪除線
  - [ ] 連結 `[text](url)`
  - [ ] 圖片 `![alt](path)`
  - [ ] 程式碼區塊
  - [ ] 引用區塊
  - [ ] 表格

- [ ] **Obsidian 內部連結**
  - [ ] 基本連結 `[[文件名稱]]`
  - [ ] 帶顯示文字 `[[文件名稱|顯示文字]]`
  - [ ] 標題連結 `[[文件名稱#標題]]`
  - [ ] 區塊連結 `[[文件名稱#^區塊id]]`

- [ ] **標籤系統**
  - [ ] 基本標籤 `#tag`
  - [ ] 巢狀標籤 `#parent/child`

- [ ] **前置元數據 (YAML Frontmatter)**
  ```yaml
  ---
  title: 文件標題
  tags: [tag1, tag2]
  date: 2026-02-17
  ---
  ```

#### 2.2 降級處理語法（Priority 2）

轉為純文字或簡化處理，不影響核心功能。

- [ ] **Callouts / Admonitions**
  ```markdown
  > [!note] 標題
  > 內容
  ```
  降級為：保留內容，移除特殊格式

- [ ] **Dataview 查詢**
  ```dataview
  TABLE file.name, file.mtime
  FROM #tag
  ```
  降級為：顯示原始查詢文字

- [ ] **嵌入內容**
  ```markdown
  ![[其他文件]]
  ```
  降級為：顯示連結而非嵌入內容

- [ ] **任務清單進階功能**
  ```markdown
  - [x] 已完成 ✅ 2026-02-17
  - [ ] 待完成 📅 2026-02-20
  ```
  降級為：標準 Markdown 任務清單

#### 2.3 不支援語法（Priority 3）

V1 不處理，可能在後續版本支援。

- [ ] Canvas（畫布）
- [ ] Excalidraw 圖表
- [ ] 複雜的外掛語法
- [ ] LaTeX 數學公式（可選）

### 3. 驗收題庫建立

建立至少 15 個測試案例，涵蓋各種使用情境。

#### 3.1 基本問答類（5 題）

**Q1: 單一文件問答**
- 問題：「Rust 的所有權規則是什麼？」
- 預期來源：`Card卡片盒/學習/程式/Rust/Rust 所有權.md`
- 驗收標準：
  - 回答必須包含所有權的三個核心規則
  - 必須標示來源檔案與行號範圍
  - 置信度 > 0.8

**Q2: 特定概念查詢**
- 問題：「Rust 中 String 和 &str 的差異？」
- 預期來源：`Card卡片盒/學習/程式/Rust/Rust String.md`
- 驗收標準：
  - 說明兩者的差異與使用時機
  - 附上程式碼範例（如果來源有）
  - 來源引用正確

**Q3: 實作方法查詢**
- 問題：「如何在 Rust 中使用 HashMap？」
- 預期來源：`Card卡片盒/學習/程式/Rust/Rust HashMap.md`
- 驗收標準：
  - 提供基本的使用方法
  - 包含新增、查詢、刪除等操作
  - 來源片段相關性高

**Q4: 概念列舉**
- 問題：「Rust 有哪些常用的 Trait？」
- 預期來源：`Card卡片盒/學習/程式/Rust/Rust std標準庫 Trait.md`
- 驗收標準：
  - 列出主要的 Trait
  - 簡單說明各 Trait 用途
  - 來源完整

**Q5: 比較類問題**
- 問題：「Vector 和陣列在 Rust 中有什麼不同？」
- 預期來源：`Card卡片盒/學習/程式/Rust/Rust Vector.md`
- 驗收標準：
  - 說明兩者差異
  - 提及使用場景
  - 引用正確片段

#### 3.2 跨文件關聯類（5 題）

**Q6: 概念關聯**
- 問題：「Rust 的所有權和引用有什麼關係？」
- 預期來源：
  - `Rust 所有權.md`
  - `Rust 引用.md`
- 驗收標準：
  - 整合兩份文件的內容
  - 說明引用如何在不轉移所有權的情況下使用值
  - 至少引用兩個來源

**Q7: 功能串聯**
- 問題：「如何使用泛型實作一個通用的 Struct？」
- 預期來源：
  - `Rust 泛型.md`
  - `Rust Struct.md`
- 驗收標準：
  - 結合泛型與結構體的知識
  - 提供完整範例或說明
  - 多個來源引用

**Q8: 錯誤處理場景**
- 問題：「在 Rust 中如何優雅地處理錯誤？」
- 預期來源：
  - `Rust 錯誤訊息.md`
  - 可能包含其他相關文件
- 驗收標準：
  - 說明 Result 和 Option 的使用
  - 提供實際場景建議
  - 來源多樣化

**Q9: 進階概念整合**
- 問題：「Enum、match 和 if let 如何搭配使用？」
- 預期來源：
  - `Rust Enum枚舉.md`
  - `Rust match & if let.md`
- 驗收標準：
  - 整合多個語法特性
  - 提供使用範例
  - 多來源整合自然

**Q10: 語言特性比較**
- 問題：「Slice 和 Vector 的切片操作有什麼關係？」
- 預期來源：
  - `Slice 切片.md`
  - `Rust Vector.md`
- 驗收標準：
  - 說明 slice 作為 Vector 的 view
  - 解釋兩者關係
  - 引用相關程式碼

#### 3.3 本機未命中類（3 題）

**Q11: 不存在的主題**
- 問題：「Python 的 asyncio 如何使用？」
- 預期行為：
  - 回應「本機資料庫中未找到相關資料」
  - 提供外部查詢選項
  - 不應直接回答（除非有網路查詢並標示）

**Q12: 部分相關但不足**
- 問題：「C++ 的 RAII 和 Rust 的所有權有什麼關係？」
- 預期行為：
  - 找到 Rust 所有權相關內容
  - 說明 C++ RAII 資料不足
  - 提示可提供外部資料或只回答已知部分

**Q13: 完全無關主題**
- 問題：「如何製作巧克力蛋糕？」
- 預期行為：
  - 明確回應「此問題超出知識庫範圍」
  - 不應嘗試回答
  - 可選：建議使用通用搜尋引擎

#### 3.4 摘要生成類（2 題）

**Q14: 單一文件摘要**
- 請求：「請摘要『Rust 所有權.md』的內容」
- 驗收標準：
  - 生成 200-300 字摘要
  - 涵蓋主要概念
  - 保持結構清晰

**Q15: 主題摘要**
- 請求：「請摘要所有 Rust 相關的文件」
- 預期來源：所有 `Card卡片盒/學習/程式/Rust/` 下的文件
- 驗收標準：
  - 生成主題概覽
  - 列出主要子主題
  - 提供文件清單

### 4. 評分標準定義

為每個測試案例定義可量化的評分標準：

#### 4.1 回答品質評分（滿分 10 分）

- **準確性（4 分）**
  - 4 分：完全正確且完整
  - 3 分：正確但不完整
  - 2 分：部分正確
  - 1 分：有嚴重錯誤
  - 0 分：完全錯誤或無關

- **來源引用（3 分）**
  - 3 分：來源完整且準確（檔名 + 行號/片段）
  - 2 分：來源正確但不完整（僅檔名）
  - 1 分：來源部分錯誤
  - 0 分：無來源或完全錯誤

- **相關性（2 分）**
  - 2 分：高度相關，直接回答問題
  - 1 分：部分相關
  - 0 分：不相關

- **可讀性（1 分）**
  - 1 分：格式清晰，易於理解
  - 0 分：格式混亂或難以理解

#### 4.2 通過標準

- 單一測試案例通過：>= 7 分
- 整體測試通過率：>= 80% (12/15 題)
- 關鍵測試（Q1-Q5, Q11-Q13）必須全部通過

### 5. 測試執行流程

1. **自動化測試**
   - 使用腳本自動執行所有問題
   - 記錄回答與來源
   - 計算初步評分

2. **人工驗收**
   - 檢查回答準確性
   - 驗證來源正確性
   - 評估可讀性與格式

3. **結果報告**
   - 產生測試報告
   - 記錄失敗案例
   - 提供改進建議

## 交付物檢查清單

- [x] 測試資料統計與說明
- [ ] Obsidian 語法支援矩陣（完整支援/降級處理/不支援）
- [ ] 驗收題庫（15+ 題）
- [ ] 評分標準文件
- [ ] 測試執行腳本（待開發）

## 預計完成時間

Phase 0 預計耗時：**1-2 週**

- 語法分析與決策：3-5 天
- 題庫設計與驗證：5-7 天
- 評分標準確認：2-3 天

## 下一步

完成 Phase 0 後，將進入 Phase 1「資料匯入與索引」的開發階段。

---

**最後更新**：2026-02-17
